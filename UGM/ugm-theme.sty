% =========================================================
% Custom Beamer Theme — mytheme.sty
% =========================================================

\ProvidesPackage{ugm-theme}

% === Dependencies ===
\usepackage{tikz}
\usepackage[cmyk]{xcolor}
\usepackage{graphics}
\usepackage[utf8]{inputenc}
\usepackage{microtype}
\ifdefined\directlua
  \usepackage{fontspec}
\else
  \usepackage[utf8]{inputenc}
  \usepackage[nomath]{lmodern}
\fi

\newcommand{\idnum}[1]{\def\insertidnum{#1}}
\newcommand{\spaced}[1]{{\addfontfeatures{LetterSpace=15}#1}}

% === Font Styles ===
\setbeamerfont{title}{series=\bfseries,size=\Huge}
\setbeamerfont{subtitle}{series=\bfseries,size=\Large}
\setbeamerfont{frametitle}{series=\bfseries,size=\Large}
\setbeamerfont{framesubtitle}{series=\bfseries,size=\large}

% === Colors ===
\setbeamercolor{title}{fg=ugmBlue}
\setbeamercolor{frametitle}{fg=ugmBlue}
\setbeamercolor{framesubtitle}{fg=ugmBlue}
\setbeamercolor{section in toc}{fg=black}
\setbeamercolor{section in toc}{fg=black,bg=}
\setbeamercolor{subsection in toc}{fg=black,bg=}
\setbeamercolor{subsubsection in toc}{fg=black,bg=}
\setbeamercolor{whitebox}{bg=white, fg=black}

% UGM Color Palette
\definecolor{ugmBlue}{cmyk}{1, 0.35, 0, 0.60} % fixed syntax
\definecolor{ugmGold}{cmyk}{0, 0.18, 1, 0}
\setbeamercolor{ugmBlue}{bg=ugmBlue}
\setbeamercolor{ugmGold}{bg=ugmGold}
\setbeamercolor{sidebarbox}{use=ugmBlue, bg=ugmBlue}

% === Remove Navigation Symbols ===
\setbeamertemplate{navigation symbols}{}

% === Background Bar ===
\setbeamertemplate{background canvas}{%
    \ifbeamer@plainframe
        \hbox to \paperwidth{%
        \hfill 
        \vbox{
          \begin{beamercolorbox}[wd=0.015\paperwidth,ht=0.13\paperwidth,dp=0pt,left]{ugmGold}%
          \end{beamercolorbox}%
          \begin{beamercolorbox}[wd=0.015\paperwidth,ht=0.83\paperheight,dp=0pt,center]{ugmBlue}%
          \end{beamercolorbox}%
          }%
        }%
\else
\vbox to 0.8\paperheight{
  \vspace{2em}
  \hbox to 0.95\paperwidth{
    \hfill
    \includegraphics[width=2cm]{resources/logo}
  }
  \vfill
}
\fi
}

% === Bottom bar ===
\setbeamertemplate{footline}{
  \leavevmode%
  \hbox{%
    \begin{beamercolorbox}[wd=.25\paperwidth,ht=2.5ex,dp=1.5ex,leftskip=0.5em,rightskip=0em]{ugmBlue}%
      \color{white}\insertauthor
    \end{beamercolorbox}%

    \begin{beamercolorbox}[wd=.5\paperwidth,ht=2.5ex,dp=1.5ex,leftskip=0.5em,rightskip=0em]{ugmBlue}%
      \color{white}\centering\tiny{\textbf{\hspace{0.5cm}
        L\kern0.2em O\kern0.2em C\kern0.2em A\kern0.2em L\kern0.2em L\kern0.2em Y\kern0.4em R\kern0.2em O\kern0.2em O\kern0.2em T\kern0.2em E\kern0.2em D,\kern0.4em G\kern0.2em L\kern0.2em O\kern0.2em B\kern0.2em A\kern0.2em L\kern0.2em L\kern0.2em Y\kern0.4em  R\kern0.2em E\kern0.2em S\kern0.2em P\kern0.2em E\kern0.2em C\kern0.2em T\kern0.2em E\kern0.2em D}}
    \end{beamercolorbox}%

    % I'm removing these for now to better fit the original template

    % \begin{beamercolorbox}[wd=.25\paperwidth,ht=2.5ex,dp=1.5ex,leftskip=0.5em,rightskip=0em]{ugmBlue}%
    %   \color{white}\centering\insertidnum
    % \end{beamercolorbox}%
    % \begin{beamercolorbox}[wd=.25\paperwidth,ht=2.5ex,dp=1.5ex,leftskip=0.5em,rightskip=0em]{ugmBlue}%
    %  \color{white}\centering\insertsection
    % \end{beamercolorbox}%


    \begin{beamercolorbox}[wd=.25\paperwidth,ht=2.5ex,dp=1.5ex,rightskip=1em]{ugmGold}%
      \hbox to .23\paperwidth{%
        \hfill 
        \makebox[0pt][c]{\usebeamercolor[fg]{title}\textbf{ugm.ac.id} }
        \hfill
        \makebox[0pt][r]{\insertframenumber\,/\,\inserttotalframenumber}%
      }%
    \end{beamercolorbox}%
  }%
  \vskip0pt%
}


% === Title Page  ===
\defbeamertemplate*{title page}{custom}[1][]{
  
    \begin{columns}[c]
      \begin{column}{0.6\linewidth}
        \hspace{0.5cm}
        \includegraphics[width=0.5\linewidth]{resources/logo}\\
        \includegraphics[height=0.6\paperheight]{resources/balairung.png}\\[1.5em]

        % is there a better way to do this? istg this seems so janky

        \usebeamercolor[fg]{subtitle}\tiny{\textbf{\hspace{0.5cm}
        L\kern0.2em O\kern0.2em C\kern0.2em A\kern0.2em L\kern0.2em L\kern0.2em Y\kern0.4em R\kern0.2em O\kern0.2em O\kern0.2em T\kern0.2em E\kern0.2em D,
        \\ \vspace{0.5em}\hspace{0.6cm}G\kern0.2em L\kern0.2em O\kern0.2em B\kern0.2em A\kern0.2em L\kern0.2em L\kern0.2em Y\kern0.4em  R\kern0.2em E\kern0.2em S\kern0.2em P\kern0.2em E\kern0.2em C\kern0.2em T\kern0.2em E\kern0.2em D}}
        
        
      \end{column}
      \begin{column}{0.5\linewidth}
        {\usebeamerfont{title}\usebeamercolor[fg]{title}\inserttitle}\\[2em]
        \begin{beamercolorbox}[wd=1cm,ht=0.2mm,dp=0.1mm,leftskip=0.5em,rightskip=0em]{ugmGold}
        \end{beamercolorbox}
        \vspace{1em}
        {\usebeamerfont{subtitle}\usebeamercolor[fg]{frametitle}\insertsubtitle}\\[1em]
        {\usebeamerfont{author}\usebeamercolor[fg]{frametitle}\insertauthor\par}
        {\usebeamerfont{author}\usebeamercolor[fg]{frametitle}\insertidnum\par}  

      \end{column}
    \end{columns}

}

% === Frame Title Template ===

\setbeamertemplate{frametitle}{
    \nointerlineskip
    \vspace{1.2cm}
    \vskip-1ex
    \begin{beamercolorbox}[wd=\paperwidth,ht=2.5ex,dp=1ex,leftskip=0.5cm]{frametitle}
        \usebeamerfont{frametitle}\insertframetitle\\
        \usebeamerfont{framesubtitle}\insertframesubtitle
    \end{beamercolorbox}
    \vspace{-0.5ex}
}

% === Itemize Style ===
\setbeamertemplate{itemize item}{\color{black}$\bullet$}
\setbeamertemplate{section in toc}{%
  \leavevmode\leftskip=0em%
  \raisebox{0.5pt}{\usebeamercolor[fg]{title}$\blacktriangleright$}\hspace{0.5em}%
  \inserttocsection\par
}


% === Thank You Page === 
\AtEndDocument{
    \begin{frame}
        \hbox to \paperwidth{
          \hfill
          \begin{beamercolorbox}[wd=4cm,ht=2cm,dp=1ex,rightskip=0.5cm]{whitebox}\end{beamercolorbox}
        }


        \begin{columns}[t]
          \begin{column}{0.5\paperwidth}
            \begin{center}
              \includegraphics[height=1.7cm]{resources/logo}\\[1cm]
                \textit{“Ini adalah text untuk kutipan atau qoutes yang menggunakan font gama-sans light italic”}
                \vfil
            \end{center}
            
            
          \end{column}
          \begin{column}{0.5\paperwidth}
            \vspace*{-2em}
            \scalebox{-1}[1]{\includegraphics[height=0.6\paperheight]{resources/balairung.png}}
          \end{column}
        \end{columns}
    \end{frame}
}

% === TikZ Defaults ===
\tikzset{every picture/.append style={remember picture=false}}

% === End of Theme ===
